@using appSchool.ViewModels
@using appSchool.Models
@using appSchool.Repositories
@{
    ViewBag.Title = "User Permission";
}

<script src="@Url.Content("~/jsControllers/userPermissionController.js")" type="text/javascript"></script>

@if (bool.Parse(Session["IsAdmin"].ToString())==false)
     {
     
              @Html.DevExpress().PopupControl(settings => {
                settings.Name = "popupclass";
                settings.PopupElementID = "popupArea";
                settings.AllowDragging = true;
                settings.ShowOnPageLoad = true;
                settings.Width=180;
                settings.Height = 100;
            
                settings.PopupHorizontalAlign =PopupHorizontalAlign.WindowCenter;
                settings.PopupVerticalAlign = PopupVerticalAlign.WindowCenter;
                settings.CloseAction = CloseAction.CloseButton;
                settings.HeaderText = "User Permission";
                settings.SetContent(() => {
                    ViewContext.Writer.Write(
                        " <p style=\"color:red;\"> Permission not granted </p>"
                    );
                    ViewContext.Writer.Write(
            "<div style=\"text-align:center;\" > <img   src=\"" + Url.Content("~/Images/permission.png") + "\" alt=\"Permission\" /> </div> "
        );
               });
}).GetHtml()
     }
else
{

   @Html.Partial("CallBackPanelPartial")
 @Html.DevExpress().Splitter(settings => {
    settings.Name = "UserPermissionSplitter";
        settings.AllowResize = true;
        settings.Orientation = System.Web.UI.WebControls.Orientation.Vertical;
        settings.Width = System.Web.UI.WebControls.Unit.Percentage(100);
        settings.Height = System.Web.UI.WebControls.Unit.Percentage(100);
        settings.SeparatorVisible = true;
        settings.ClientSideEvents.PaneResized = "userPermissionController.splitterResized";
        settings.FullscreenMode = false;
       settings.Panes.Add(subpane =>
        {
            subpane.Name = "UserPermissionBody";
            subpane.PaneStyle.CssClass = "contentPane";
            subpane.ScrollBars = System.Web.UI.WebControls.ScrollBars.Auto;
            subpane.MinSize = System.Web.UI.WebControls.Unit.Pixel(50);
            subpane.Size = System.Web.UI.WebControls.Unit.Pixel(50);
            subpane.Separator.Visible = DefaultBoolean.False;
            subpane.Separator.SeparatorStyle.Border.BorderWidth = System.Web.UI.WebControls.Unit.Pixel(0);
            subpane.Separator.SeparatorStyle.BorderTop.BorderWidth = System.Web.UI.WebControls.Unit.Pixel(0);
            subpane.SetContent(() =>
            {
              //  Html.RenderPartial("ListStudentSessionView", (new UnitOfWork().studentSessionService.GetAllStudentForSession(int.Parse(Session["SessionID"].ToString()))));

                ViewContext.Writer.Write("<table class='tblStudFeeSturct'><tr><td>");
                
                @Html.DevExpress().Label(settingslbl =>
                {
                    settingslbl.Name = "lb";
                    settingslbl.Width = System.Web.UI.WebControls.Unit.Percentage(100);
                    settingslbl.Text = "Select User Name";
                    
                }).GetHtml();
                ViewContext.Writer.Write("</td><td>");
                
                @Html.DevExpress().ComboBox(

              settingscbo =>
              {
                  settingscbo.Name = "UserID";
                  settingscbo.ControlStyle.CssClass = "editor";
                  settingscbo.Properties.IncrementalFilteringMode = IncrementalFilteringMode.StartsWith;
                  settingscbo.Properties.DropDownStyle = DropDownStyle.DropDown;
                  settingscbo.Width = System.Web.UI.WebControls.Unit.Pixel(200);
                  settingscbo.Properties.TextField = "UserName";
                  settingscbo.Properties.ValueField = "UserID";
                  //settingscbo.ShowModelErrors = true;
                  //settingscbo.Properties.ValidationSettings.ErrorDisplayMode = ErrorDisplayMode.ImageWithTooltip;
                 // settingscbo.Properties.ClientSideEvents.SelectedIndexChanged = "studentSessionController.SelectedClass";
                  settingscbo.Properties.ClientSideEvents.SelectedIndexChanged = "userPermissionController.SelectedUser";
              }
            ).BindList(new UnitOfWork().userLoginService.GetUserLoginList(byte.Parse(Session["CompID"].ToString()),byte.Parse(Session["BranchID"].ToString()))).GetHtml();

                ViewContext.Writer.Write("</td><td>");

                @Html.DevExpress().Button(
           settingsSend =>
           {
               settingsSend.Name = "btnSave";
               settingsSend.Width = 150;
               //settings.Height = 25;
               settingsSend.RenderMode = ButtonRenderMode.Button;
               settingsSend.Text = "Retrive All Modules";
               settingsSend.ToolTip = "To load all the modules";
               settingsSend.ImagePosition = ImagePosition.Right;
               settingsSend.Images.Image.IconID = "actions_refresh_16x16gray";
               settingsSend.ClientSideEvents.Click = "userPermissionController.CreateUserPermission";


              // settingsSend.ClientSideEvents.Click = "function(s, e) {  CallbackPanelUP.PerformCallback(); }";
              

           }).GetHtml();

                @Html.DevExpress().LoadingPanel(
   settingslp =>
   {
       settingslp.Name = "LoadingPanelUserPermission";
       settingslp.Modal = true;
       settingslp.ContainerElementID = "";
       settingslp.Styles.LoadingDiv.BackColor = System.Drawing.Color.White;
       //settingslp.ContainerElementID = false ? "Panel" : "";
   }
).GetHtml();
                ViewContext.Writer.Write("</td><td>");

                @Html.DevExpress().TextBox(
                  settingscls =>
                  {
                      settingscls.Name = "txtUserName";
                      settingscls.ClientVisible = false;

                  }).GetHtml();
                
                
                 // ViewContext.Writer.Write("</td><td>");
                
                 // @Html.DevExpress().CheckBox(settingchk =>
                 //{
                 //    settingchk.Name = "cbAdd";
                 //    settingchk.Text = "Add";
                 //   // settingchk.ControlStyle.ForeColor = System.Drawing.Color.Red;
                 //   // settingchk.ControlStyle.Font.Size = 14;
                 //   // settingchk.Properties.ClientSideEvents.CheckedChanged = "userPermissionController.SelectAllStudent";
                 //    // settingchk.Checked = c.Grid.VisibleRowCount == c.Grid.Selection.Count;
                 //}).GetHtml();

                 // ViewContext.Writer.Write("</td><td>");

                 // @Html.DevExpress().CheckBox(settingchk =>
                 // {
                 //     settingchk.Name = "cbMod";
                 //     settingchk.Text = "Modify";
                 //    // settingchk.ControlStyle.ForeColor = System.Drawing.Color.Red;
                 //     //settingchk.ControlStyle.Font.Size = 14;
                 //    // settingchk.Properties.ClientSideEvents.CheckedChanged = "userPermissionController.SelectAllStudent";
                 //     // settingchk.Checked = c.Grid.VisibleRowCount == c.Grid.Selection.Count;
                 // }).GetHtml();
                 // ViewContext.Writer.Write("</td><td>");

                 // @Html.DevExpress().CheckBox(settingchk =>
                 // {
                 //     settingchk.Name = "cbDel";
                 //     settingchk.Text = "Delete";
                 //    // settingchk.ControlStyle.ForeColor = System.Drawing.Color.Red;
                 //    // settingchk.ControlStyle.Font.Size = 14;
                 //     //settingchk.Properties.ClientSideEvents.CheckedChanged = "userPermissionController.SelectAllStudent";
                 //     // settingchk.Checked = c.Grid.VisibleRowCount == c.Grid.Selection.Count;
                 // }).GetHtml();
                  ViewContext.Writer.Write("</td><td>");
                  @Html.DevExpress().CheckBoxList(settingschkbox =>
                  {
                      settingschkbox.Name = "chkBoxLstAll";
                      settingschkbox.Properties.RepeatDirection = System.Web.UI.WebControls.RepeatDirection.Horizontal;
                      settingschkbox.Properties.Items.Add("Add").Selected = false;
                      settingschkbox.Properties.Items.Add("Modify");
                      settingschkbox.Properties.Items.Add("Delete");
                    
                          
                     // settingschkbox.Properties.ClientSideEvents.SelectedIndexChanged = "function(s, e) { alert(s.GetSelectedValues()); }";
                  }).GetHtml();
                
                
                  ViewContext.Writer.Write("</td><td>");
                  @Html.DevExpress().Button(
           settingsSend =>
           {
               settingsSend.Name = "btnAllSelect";
               settingsSend.Width = 150;
               //settings.Height = 25;
               settingsSend.RenderMode = ButtonRenderMode.Button;
               settingsSend.Text = "Apply to all";
               settingsSend.ImagePosition = ImagePosition.Right;
               settingsSend.ToolTip = "Apply selected permission to all";
               settingsSend.Images.Image.IconID = "actions_refresh_16x16gray";
             settingsSend.ClientSideEvents.Click = "userPermissionController.SetAllUserPermission";
              
           //     settingsSend.ClientSideEvents.Click = "function(s, e) {  CallbackPanelUP.PerformCallback(); }";


           }).GetHtml();
                

                ViewContext.Writer.Write("</td></tr></table>");
                  
            });
        });
       settings.Panes.Add(subpane =>
       {
           subpane.Name = "UserPermissionFooter";
           subpane.PaneStyle.CssClass = "contentPane";
           subpane.ScrollBars = System.Web.UI.WebControls.ScrollBars.Auto;
           subpane.MinSize = System.Web.UI.WebControls.Unit.Pixel(100);
           subpane.Size = System.Web.UI.WebControls.Unit.Percentage(40);
           subpane.Separator.Visible = DefaultBoolean.True;
           subpane.Separator.SeparatorStyle.Border.BorderWidth = System.Web.UI.WebControls.Unit.Pixel(0);
           subpane.Separator.SeparatorStyle.BorderTop.BorderWidth = System.Web.UI.WebControls.Unit.Pixel(0);
           subpane.SetContent(() =>
           {
               Html.RenderPartial("ListUserPermissionView");
               //Html.RenderPartial("RegistrationTabs",(int)1);
           });
       });
    }).GetHtml()





}











