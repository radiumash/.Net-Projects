@using appSchool.Repositories
@using appSchool.ViewModels

@if (ViewData["pGalleryID"] == null)
{
    ViewData["pGalleryID"] = 0;
}
@if (ViewData["pFolderName"] == null)
{
    ViewData["pFolderName"] = "";
}

@{ 
    var grid = Html.DevExpress().GridView(
                    settings =>
                    {
                        settings.Name = "gridView"; ////name change this propert to new
                        settings.KeyFieldName = "GalleryDetailID";
                        settings.Width = System.Web.UI.WebControls.Unit.Percentage(99);
                        //settings.Height = System.Web.UI.WebControls.Unit.Percentage(100);
                        // settings.Caption="Students List for Current Session";
                        settings.CommandColumn.Visible = true;
                        var FolderName = ViewData["pFolderName"];
                        settings.CommandColumn.Width = System.Web.UI.WebControls.Unit.Pixel(40);
                        settings.CommandColumn.ShowSelectCheckbox = true;
                        settings.CommandColumn.ShowClearFilterButton = true;

                        settings.ControlStyle.CssClass = "grid-view"; //add this propert to new
                        settings.Styles.PagerBottomPanel.CssClass = "pager";
                        settings.Styles.FocusedRow.CssClass = "focused";
                        settings.Settings.VerticalScrollBarMode = ScrollBarMode.Hidden;
                        settings.Settings.HorizontalScrollBarMode = ScrollBarMode.Auto;
                        settings.SettingsPager.PageSize = 10;
                //settings.SettingsPager.EnableAdaptivity = true;
                //settings.SettingsPager.PageSizeItemSettings.Visible = true;

                settings.CommandButtonInitialize = (sender, e) =>
                        {
                            if ((e.ButtonType == ColumnCommandButtonType.PreviewChanges) || (e.ButtonType == ColumnCommandButtonType.Cancel))
                            {
                                e.Visible = false;
                            }
                        };


                        settings.CommandColumn.Caption = "Select";
                        settings.CommandColumn.SetHeaderTemplateContent(c =>
                        {
                            Html.DevExpress().CheckBox(settingsCheckBox =>
                            {
                                settingsCheckBox.Name = "cbSelectAllSS";
                        // settingsCheckBox.Text = "Select";
                        settingsCheckBox.Properties.ClientSideEvents.CheckedChanged = string.Format("function(s, e) {{ if(s.GetChecked()) {0}.SelectRows(); else {0}.UnselectRows(); }}", settings.Name);
                                settingsCheckBox.Checked = c.Grid.VisibleRowCount == c.Grid.Selection.Count;
                            }).Render();
                        });

                        settings.ClientSideEvents.SelectionChanged = "photogallerydetailController.SelectionChanged";

                        settings.CallbackRouteValues = new { Controller = "PhotoGalleryDetail", Action = "PartialPhotoGalleryDetail", mGalleryID = ViewData["pGalleryID"], mFolderName = ViewData["pFolderName"] };

                        settings.SettingsEditing.BatchUpdateRouteValues = new { Controller = "PhotoGalleryDetail", Action = "UpdatePartialPhotoOrder", mGalleryID = ViewData["pGalleryID"], mFolderName = ViewData["pFolderName"] };

                        settings.SettingsEditing.Mode = GridViewEditingMode.Batch;
                        settings.SettingsEditing.BatchEditSettings.EditMode = appSchool.Controllers.GridViewEditingDemosHelper.BatchEditMode;
                        settings.SettingsEditing.BatchEditSettings.StartEditAction = appSchool.Controllers.GridViewEditingDemosHelper.BatchStartEditAction;
                // settings.SettingsCommandButton.EditButton.ButtonType = GridViewCommandButtonType.Button;

                settings.SettingsBehavior.ConfirmDelete = true;

                        settings.SettingsPopup.EditForm.ShowHeader = true;


                        settings.Columns.Add("GalleryDetailID").Visible = false;
                        settings.Columns.Add(column =>
                        {
                            column.FieldName = "PhotoName";
                            column.Caption = "Image";
                            column.ColumnType = MVCxGridViewColumnType.TextBox;
                            column.Width = System.Web.UI.WebControls.Unit.Pixel(800);
                            column.ReadOnly = true;

                      

                        });
                        settings.Columns.Add(column =>
                        {
                            column.FieldName = "PhotoOrder";
                            column.Caption = "Photo Order";
                            column.ColumnType = MVCxGridViewColumnType.TextBox;
                            column.Width = System.Web.UI.WebControls.Unit.Pixel(100);
                            column.ReadOnly = true;
                        });
                      


                //settings.SettingsPager.Position = System.Web.UI.WebControls.PagerPosition.Bottom;
                //settings.SettingsPager.FirstPageButton.Visible = true;
                //settings.SettingsPager.LastPageButton.Visible = true;
                //settings.SettingsPager.PageSizeItemSettings.Visible = true;
                ////settings.SettingsPager.PageSize = 200;
                //settings.Settings.ShowFilterRow = true;
                //settings.Settings.ShowFilterRowMenu = true;

                //settings.CommandColumn.ShowClearFilterButton = true;
                //settings.PreRender = (sender, e) => {
                //    //((MVCxGridView)sender).StartEdit(1);
                //};

                //settings.Settings.VerticalScrollBarMode = ScrollBarMode.Visible;

            });

                if (ViewData["EditError"] != null)
                {
                    grid.SetEditErrorText((string)ViewData["EditError"]);
                } }
@grid.Bind(Model).GetHtml()


